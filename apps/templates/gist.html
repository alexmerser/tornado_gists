{% extends "base.html" %}

{% block title %}
<title>{{ gist.description }} | Tornado Gists</title>
{% end %}

{% block extra_head %}
<style type="text/css">
p.discussion { margin-top:1em; margin-bottom:0; }
div.discussion { margin:15px 10px; }
</style>
{% end %}

{% block main %}

{% if edit %}
<form action="." method="post">{{ xsrf_form_html() }}
{% end %}

<h2>{{ gist.gist_id }}:
{% if edit %}
<input style="width:100%" name="description" value="{{ gist.description }}" />
{% else %}
{{ gist.description }}
{% end %}
</h2>

{% if edit %}
  <p class="discussion"><label>Discussion:</label></p>
  <div><textarea name="discussion" style="width:100%" cols="80" rows="10">{{ gist.discussion }}</textarea></div>
  <p style="float:right">Text is rendered as <a href="http://daringfireball.net/projects/markdown/syntax">Markdown</a></p>
  <p><input type="submit" value="Save" /> <a href="{{ reverse_url('view_gist', gist.gist_id) }}">Cancel</a></p>
  </form>
{% else %}
  {% if gist.discussion %}
  <div class="discussion">{{ modules.RenderText(gist.discussion, gist.discussion_format) }}</div>
  {% end %}
  {% if user and gist.user == user %}
  <p>Your gist, wanna <a onclick="return confirm('Are you sure you want to delete it entirely?')"
  href="{{ reverse_url('delete_gist', gist.gist_id) }}">delete it</a> or
  <a href="{{ reverse_url('edit_gist', gist.gist_id) }}">edit it</a>?</p>
  {% end %}
{% end %}


{% for i, filename in enumerate(gist.files) %}
<p>File: <code>{{ filename }}</code></p>
<script src="https://gist.github.com/{{ gist.gist_id }}.js?file={{ filename }}"></script>
{% end %}

{% end %}<!-- end main block -->
